<!DOCTYPE html>
<html>
 <head> 
  <meta charset="utf-8" /> 
  <meta http-equiv="X-UA-Compatible" content="chrome=1" /> 
  <link rel="stylesheet" type="text/css" href="../../stylesheets/stylesheet.css" media="screen" /> 
  <link rel="stylesheet" type="text/css" href="../../stylesheets/pygment_trac.css" media="screen" /> 
  <link rel="stylesheet" type="text/css" href="../../stylesheets/print.css" media="print" /> 
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--> 
  <title>TFS-HA部署</title> 
 </head> 
 <body> 
  <div id="container"> 
   <div class="inner"> 
    <header> 
     <h1><a style="color:#000" href="http://smartmz.github.io/" target="_blank">SmartMZ的Block</a></h1> 
     <h2>积累</h2> 
    </header> 
    <hr /> 
    <section id="main_content"> 
     <h3>【TFS】TFS-HA部署</h3> 
     <p>TaobaoFS搭建HA</p> 
     <hr /> 
	 <p>淘宝的TFS可以选择使用HA搭建，增强集群的高可用性。HA主要体现在NameServer节点的主备搭建。</p>
	 <p>官方使用的Heartbeat是v3的版本，在机器级别可以对节点进行监控，如果其中一个NS机器宕机（或网络中断）后可以做出响应；如果需要进一步对NS节点的资源（Nameserver服务）进行监控，要使用CRM模式实现资源管理。</p>
	 <p>Heartbeat v3已经将heartbeat、CRM拆分，heartbeat只负责心跳信息的通信，CRM部分主要有Pacemaker等实现资源管理，如果选择使用Pacemaker的话，还可以用CMAN来实现来代替heartbeat.因此，搭建TFS-HA集群时NS的主备部署可以有三种方式：</p>
	 <ul>
	 	<li>NameServer×2 + heartbeat + DataServer×N，节点（机器）级别的HA</li>
	 	<li>NameServer×2 + heartbeat + Pacemaker + DataServer×N，资源级别的HA，官方</li>
	 	<li>NameServer×2 + CMAN + Pacemaker + DataServer×N，资源级别的HA</li>
	 </ul>
   <h4>NameServer×2 + heartbeat + DataServer×N</h4>
   <p>本次使用的软件版本为：</p>
   <ul>
     <li>CentOS release 5.10 (Final)</li>
     <li>heartbeat-3.0.3-2.3.el5</li>
     <li>heartbeat-libs-3.0.3-2.3.el5</li>
   </ul>
   <p>heartbeat可以直接通过YUM源安装，也可以下载RPM或编译安装。</p>
    </section> 
    <footer>
      This page was generated by 
     <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by 
     <a href="https://twitter.com/jasonlong">Jason Long</a>. 
    </footer> 
   </div> 
  </div>   
 </body>
</html>